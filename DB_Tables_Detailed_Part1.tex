\documentclass[11pt,a4paper]{article}

% Packages
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{tcolorbox}
\usepackage{longtable}
\usepackage{array}
\usepackage{booktabs}
\usepackage{tikz}

% Page geometry
\geometry{
    left=2cm,
    right=2cm,
    top=2.5cm,
    bottom=2.5cm
}

% Color definitions
\definecolor{primaryBlue}{RGB}{0, 102, 204}
\definecolor{accentOrange}{RGB}{255, 127, 0}
\definecolor{darkGray}{RGB}{51, 51, 51}
\definecolor{lightGray}{RGB}{245, 245, 245}
\definecolor{tableHeader}{RGB}{25, 118, 210}

% Title formatting
\titleformat{\section}
  {\color{primaryBlue}\Large\bfseries}
  {\thesection}{1em}{}[\titlerule]

\titleformat{\subsection}
  {\color{accentOrange}\large\bfseries}
  {\thesubsection}{1em}{}

% Hyperref setup
\hypersetup{
    colorlinks=true,
    linkcolor=primaryBlue,
    filecolor=accentOrange,
    urlcolor=primaryBlue,
    pdftitle={SavoyConnect Database Tables - Part 1},
    pdfauthor={Rifaf Rahman}
}

% Header and footer
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\color{primaryBlue}\textbf{SavoyConnect Database - Part 1}}
\fancyhead[R]{\color{darkGray}\thepage}
\fancyfoot[C]{\color{darkGray}\small Tables 1-10 | Prepared by Rifaf Rahman | November 2025}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0.5pt}

% Custom boxes
\newtcolorbox{tablebox}[1]{
  colback=lightGray,
  colframe=primaryBlue,
  fonttitle=\bfseries\large,
  title=#1,
  arc=2mm,
  boxrule=1mm
}

\begin{document}

% Title page
\begin{titlepage}
    \begin{tikzpicture}[remember picture,overlay]
        \fill[primaryBlue] (current page.north west) rectangle ([yshift=-8cm]current page.north east);
    \end{tikzpicture}
    
    \vspace*{2cm}
    
    {\color{white}\Huge\bfseries SavoyConnect}\\[0.5cm]
    {\color{white}\LARGE Database Schema - Part 1}\\[0.3cm]
    {\color{white}\Large Detailed Table Properties}\\[2cm]
    
    \vspace{3cm}
    
    \begin{tcolorbox}[colback=white,colframe=accentOrange,width=0.8\textwidth,arc=3mm,boxrule=1mm]
        \begin{tabular}{ll}
            \textbf{\color{primaryBlue}Prepared by:} & Rifaf Rahman \\[0.3cm]
            \textbf{\color{primaryBlue}Document:} & Part 1 of 8 \\[0.3cm]
            \textbf{\color{primaryBlue}Tables:} & 1-10 (MVP Phase) \\[0.3cm]
            \textbf{\color{primaryBlue}Date:} & November 9, 2025 \\
        \end{tabular}
    \end{tcolorbox}
    
    \vfill
    
    {\large\color{darkGray} Complete Column Definitions with Data Types \& Constraints}
    
\end{titlepage}

\tableofcontents
\newpage

\section{User Management \& Authentication Tables}

\subsection{Table 1: users}

\begin{tablebox}{users - Core User Accounts}
\textbf{Purpose:} Stores core user authentication and account information.\\
\textbf{Primary Key:} id\\
\textbf{Indexes:} email (unique), phone (unique), created\_at
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
email & VARCHAR(255) & UNIQUE, NOT NULL, Valid email format \\
\hline
phone & VARCHAR(20) & UNIQUE, NOT NULL, E.164 format (+880...) \\
\hline
password\_hash & VARCHAR(255) & NOT NULL, Bcrypt/Argon2 hashed password \\
\hline
email\_verified\_at & TIMESTAMP & NULL, Timestamp when email was verified \\
\hline
phone\_verified\_at & TIMESTAMP & NULL, Timestamp when phone was verified \\
\hline
status & ENUM & NOT NULL, DEFAULT 'active', Values: 'active', 'suspended', 'deactivated', 'pending' \\
\hline
last\_login\_at & TIMESTAMP & NULL, Last successful login timestamp \\
\hline
login\_attempts & INT & NOT NULL, DEFAULT 0, Failed login counter for security \\
\hline
locked\_until & TIMESTAMP & NULL, Account lock expiration for security \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
updated\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP \\
\hline
deleted\_at & TIMESTAMP & NULL, Soft delete timestamp \\
\hline
\caption{users table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item One-to-One: user\_profiles, wallet\_accounts, health\_profiles
    \item One-to-Many: orders, reviews, community\_posts, user\_addresses
\end{itemize}

\newpage

\subsection{Table 2: user\_profiles}

\begin{tablebox}{user\_profiles - Extended User Information}
\textbf{Purpose:} Stores detailed user profile information and personal data.\\
\textbf{Primary Key:} id\\
\textbf{Foreign Keys:} user\_id (references users.id)\\
\textbf{Indexes:} user\_id (unique), date\_of\_birth
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
user\_id & BIGINT & FOREIGN KEY, UNIQUE, NOT NULL, References users(id) ON DELETE CASCADE \\
\hline
full\_name & VARCHAR(255) & NOT NULL, User's full name \\
\hline
date\_of\_birth & DATE & NULL, User's birth date for age verification and birthday features \\
\hline
gender & ENUM & NULL, Values: 'male', 'female', 'other', 'prefer\_not\_to\_say' \\
\hline
city & VARCHAR(100) & NULL, User's city for location-based features \\
\hline
profile\_picture\_url & VARCHAR(500) & NULL, URL to profile image stored in cloud storage \\
\hline
bio & TEXT & NULL, User bio/description (max 500 characters) \\
\hline
language\_preference & VARCHAR(10) & NOT NULL, DEFAULT 'en', ISO 639-1 language code \\
\hline
timezone & VARCHAR(50) & NOT NULL, DEFAULT 'Asia/Dhaka', IANA timezone identifier \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
updated\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP \\
\hline
\caption{user\_profiles table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item Many-to-One: users (user\_id)
\end{itemize}

\newpage

\subsection{Table 3: user\_preferences}

\begin{tablebox}{user\_preferences - User Settings \& Preferences}
\textbf{Purpose:} Stores user preferences for notifications, dietary restrictions, and app settings.\\
\textbf{Primary Key:} id\\
\textbf{Foreign Keys:} user\_id (references users.id)\\
\textbf{Indexes:} user\_id (unique)
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
user\_id & BIGINT & FOREIGN KEY, UNIQUE, NOT NULL, References users(id) ON DELETE CASCADE \\
\hline
dietary\_preferences & JSON & NULL, Array of dietary preferences: ['vegetarian', 'vegan', 'low-sugar', 'keto', etc.] \\
\hline
allergen\_restrictions & JSON & NULL, Array of allergens to avoid: ['dairy', 'nuts', 'gluten', 'soy', etc.] \\
\hline
push\_notifications & BOOLEAN & NOT NULL, DEFAULT TRUE, Enable/disable push notifications \\
\hline
email\_notifications & BOOLEAN & NOT NULL, DEFAULT TRUE, Enable/disable email notifications \\
\hline
sms\_notifications & BOOLEAN & NOT NULL, DEFAULT FALSE, Enable/disable SMS notifications \\
\hline
marketing\_emails & BOOLEAN & NOT NULL, DEFAULT TRUE, Consent for marketing communications \\
\hline
order\_updates & BOOLEAN & NOT NULL, DEFAULT TRUE, Notifications for order status changes \\
\hline
promotional\_offers & BOOLEAN & NOT NULL, DEFAULT TRUE, Notifications for promotions and deals \\
\hline
challenge\_reminders & BOOLEAN & NOT NULL, DEFAULT TRUE, Reminders for active challenges \\
\hline
theme\_preference & ENUM & NOT NULL, DEFAULT 'system', Values: 'light', 'dark', 'system' \\
\hline
default\_payment\_method & VARCHAR(50) & NULL, Default payment method preference \\
\hline
data\_sharing\_consent & BOOLEAN & NOT NULL, DEFAULT FALSE, Consent for analytics and personalization \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
updated\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP \\
\hline
\caption{user\_preferences table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item Many-to-One: users (user\_id)
\end{itemize}

\newpage

\subsection{Table 4: user\_addresses}

\begin{tablebox}{user\_addresses - Delivery Address Management}
\textbf{Purpose:} Stores multiple delivery addresses for users with geocoding support.\\
\textbf{Primary Key:} id\\
\textbf{Foreign Keys:} user\_id (references users.id)\\
\textbf{Indexes:} user\_id, is\_default
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
user\_id & BIGINT & FOREIGN KEY, NOT NULL, References users(id) ON DELETE CASCADE \\
\hline
label & VARCHAR(50) & NOT NULL, Address label: 'Home', 'Office', 'Other' \\
\hline
address\_line\_1 & VARCHAR(255) & NOT NULL, Street address, building name/number \\
\hline
address\_line\_2 & VARCHAR(255) & NULL, Apartment, suite, floor details \\
\hline
city & VARCHAR(100) & NOT NULL, City name \\
\hline
postal\_code & VARCHAR(20) & NULL, Postal/ZIP code \\
\hline
district & VARCHAR(100) & NULL, District/state/province \\
\hline
country & VARCHAR(100) & NOT NULL, DEFAULT 'Bangladesh', Country name \\
\hline
latitude & DECIMAL(10, 8) & NULL, GPS latitude for geocoding and delivery routing \\
\hline
longitude & DECIMAL(11, 8) & NULL, GPS longitude for geocoding and delivery routing \\
\hline
landmark & VARCHAR(255) & NULL, Nearby landmark for easier navigation \\
\hline
phone & VARCHAR(20) & NULL, Contact phone for this address \\
\hline
is\_default & BOOLEAN & NOT NULL, DEFAULT FALSE, Primary delivery address flag \\
\hline
is\_verified & BOOLEAN & NOT NULL, DEFAULT FALSE, Address verification status \\
\hline
delivery\_instructions & TEXT & NULL, Special delivery notes (gate code, directions, etc.) \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
updated\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP \\
\hline
deleted\_at & TIMESTAMP & NULL, Soft delete timestamp \\
\hline
\caption{user\_addresses table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item Many-to-One: users (user\_id)
    \item One-to-Many: orders (delivery\_address\_id)
\end{itemize}

\newpage

\subsection{Table 5: sessions}

\begin{tablebox}{sessions - User Session Management}
\textbf{Purpose:} Manages active user sessions with device tracking and security.\\
\textbf{Primary Key:} id\\
\textbf{Foreign Keys:} user\_id (references users.id)\\
\textbf{Indexes:} user\_id, token (unique), expires\_at
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
user\_id & BIGINT & FOREIGN KEY, NOT NULL, References users(id) ON DELETE CASCADE \\
\hline
token & VARCHAR(255) & UNIQUE, NOT NULL, Session token (JWT or random string) \\
\hline
device\_type & ENUM & NOT NULL, Values: 'mobile', 'tablet', 'desktop', 'unknown' \\
\hline
device\_name & VARCHAR(255) & NULL, Device model/name (e.g., "iPhone 13", "Chrome Browser") \\
\hline
os & VARCHAR(100) & NULL, Operating system (e.g., "iOS 16", "Windows 11") \\
\hline
browser & VARCHAR(100) & NULL, Browser name and version \\
\hline
ip\_address & VARCHAR(45) & NULL, IPv4 or IPv6 address \\
\hline
user\_agent & TEXT & NULL, Full user agent string \\
\hline
last\_activity\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP, Last request timestamp \\
\hline
expires\_at & TIMESTAMP & NOT NULL, Session expiration timestamp \\
\hline
is\_active & BOOLEAN & NOT NULL, DEFAULT TRUE, Session active status \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
\caption{sessions table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item Many-to-One: users (user\_id)
\end{itemize}

\textbf{Notes:}
\begin{itemize}
    \item Implement automatic cleanup of expired sessions (cron job)
    \item Consider using Redis for session storage in production for better performance
    \item Track concurrent sessions per user for security monitoring
\end{itemize}

\newpage

\subsection{Table 6: password\_resets}

\begin{tablebox}{password\_resets - Password Reset Token Management}
\textbf{Purpose:} Manages password reset tokens with expiration and usage tracking.\\
\textbf{Primary Key:} id\\
\textbf{Indexes:} email, token (unique), expires\_at
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
email & VARCHAR(255) & NOT NULL, User email for password reset \\
\hline
token & VARCHAR(255) & UNIQUE, NOT NULL, Secure random reset token (hashed) \\
\hline
expires\_at & TIMESTAMP & NOT NULL, Token expiration (typically 1 hour from creation) \\
\hline
used\_at & TIMESTAMP & NULL, Timestamp when token was used \\
\hline
ip\_address & VARCHAR(45) & NULL, IP address of reset request for security audit \\
\hline
user\_agent & TEXT & NULL, User agent of reset request \\
\hline
is\_used & BOOLEAN & NOT NULL, DEFAULT FALSE, Token usage status \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
\caption{password\_resets table structure}
\end{longtable}

\textbf{Security Considerations:}
\begin{itemize}
    \item Tokens should be cryptographically secure random strings
    \item Store hashed version of token in database
    \item Implement rate limiting on reset requests per email/IP
    \item Expire tokens after 1 hour or first use
    \item Clean up expired/used tokens regularly
    \item Send notification email when password is successfully changed
\end{itemize}

\newpage

\section{Product Catalog Tables}

\subsection{Table 7: products}

\begin{tablebox}{products - Ice Cream Products \& SKUs}
\textbf{Purpose:} Core product catalog with pricing, units, and availability.\\
\textbf{Primary Key:} id\\
\textbf{Indexes:} sku (unique), name, category\_id, is\_active, created\_at
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
sku & VARCHAR(100) & UNIQUE, NOT NULL, Stock Keeping Unit identifier \\
\hline
name & VARCHAR(255) & NOT NULL, Product/flavor name \\
\hline
slug & VARCHAR(255) & UNIQUE, NOT NULL, URL-friendly name \\
\hline
description & TEXT & NULL, Detailed product description \\
\hline
short\_description & VARCHAR(500) & NULL, Brief product summary for listings \\
\hline
category\_id & BIGINT & FOREIGN KEY, NULL, References product\_categories(id) \\
\hline
base\_price & DECIMAL(10, 2) & NOT NULL, Base price in local currency (BDT) \\
\hline
unit\_type & ENUM & NOT NULL, Values: 'piece', 'liter', 'box', 'scoop' \\
\hline
units\_per\_package & INT & NOT NULL, DEFAULT 1, Number of units in one package \\
\hline
minimum\_order\_quantity & INT & NOT NULL, DEFAULT 1, Minimum order quantity \\
\hline
weight\_grams & INT & NULL, Product weight in grams for shipping \\
\hline
volume\_ml & INT & NULL, Product volume in milliliters \\
\hline
is\_active & BOOLEAN & NOT NULL, DEFAULT TRUE, Product availability status \\
\hline
is\_featured & BOOLEAN & NOT NULL, DEFAULT FALSE, Featured product flag for promotions \\
\hline
is\_new & BOOLEAN & NOT NULL, DEFAULT FALSE, New product flag \\
\hline
is\_seasonal & BOOLEAN & NOT NULL, DEFAULT FALSE, Seasonal availability \\
\hline
season\_start & DATE & NULL, Season start date for seasonal products \\
\hline
season\_end & DATE & NULL, Season end date for seasonal products \\
\hline
average\_rating & DECIMAL(3, 2) & NULL, DEFAULT 0.00, Calculated average rating (0-5) \\
\hline
total\_reviews & INT & NOT NULL, DEFAULT 0, Total review count \\
\hline
total\_sales & INT & NOT NULL, DEFAULT 0, Lifetime sales count \\
\hline
view\_count & INT & NOT NULL, DEFAULT 0, Product view count \\
\hline
sort\_order & INT & NOT NULL, DEFAULT 0, Display sort order \\
\hline
meta\_title & VARCHAR(255) & NULL, SEO meta title \\
\hline
meta\_description & TEXT & NULL, SEO meta description \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
updated\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP \\
\hline
deleted\_at & TIMESTAMP & NULL, Soft delete timestamp \\
\hline
\caption{products table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item Many-to-One: product\_categories (category\_id)
    \item One-to-Many: order\_items, product\_reviews, product\_nutrition, product\_images
    \item One-to-Many: location\_inventory, custom\_box\_items
\end{itemize}

\newpage

\subsection{Table 8: product\_categories}

\begin{tablebox}{product\_categories - Product Categorization}
\textbf{Purpose:} Hierarchical product category structure for organization and filtering.\\
\textbf{Primary Key:} id\\
\textbf{Indexes:} slug (unique), parent\_id, is\_active
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
parent\_id & BIGINT & FOREIGN KEY, NULL, References product\_categories(id) for hierarchy \\
\hline
name & VARCHAR(255) & NOT NULL, Category name \\
\hline
slug & VARCHAR(255) & UNIQUE, NOT NULL, URL-friendly category name \\
\hline
description & TEXT & NULL, Category description \\
\hline
icon & VARCHAR(255) & NULL, Icon name or URL for category \\
\hline
image\_url & VARCHAR(500) & NULL, Category banner/header image \\
\hline
color\_code & VARCHAR(7) & NULL, Hex color code for UI theming \\
\hline
is\_active & BOOLEAN & NOT NULL, DEFAULT TRUE, Category visibility status \\
\hline
sort\_order & INT & NOT NULL, DEFAULT 0, Display order within parent \\
\hline
level & INT & NOT NULL, DEFAULT 0, Hierarchy level (0=root, 1=child, etc.) \\
\hline
path & VARCHAR(500) & NULL, Full path for nested set or materialized path (e.g., "/premium/chocolate") \\
\hline
product\_count & INT & NOT NULL, DEFAULT 0, Cached count of products in category \\
\hline
meta\_title & VARCHAR(255) & NULL, SEO meta title \\
\hline
meta\_description & TEXT & NULL, SEO meta description \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
updated\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP \\
\hline
deleted\_at & TIMESTAMP & NULL, Soft delete timestamp \\
\hline
\caption{product\_categories table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item Self-referencing: parent\_id references product\_categories(id)
    \item One-to-Many: products (category\_id)
\end{itemize}

\textbf{Example Categories:}
\begin{itemize}
    \item Premium (parent) → Belgian Chocolate, French Vanilla (children)
    \item Classic (parent) → Vanilla, Chocolate, Strawberry (children)
    \item Seasonal (parent) → Summer Special, Winter Collection (children)
    \item Sugar-Free, Vegan Options, Kids Favorites
\end{itemize}

\newpage

\subsection{Table 9: product\_nutrition}

\begin{tablebox}{product\_nutrition - Nutritional Information}
\textbf{Purpose:} Detailed nutritional facts per product for health-conscious features.\\
\textbf{Primary Key:} id\\
\textbf{Foreign Keys:} product\_id (references products.id)\\
\textbf{Indexes:} product\_id (unique)
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
product\_id & BIGINT & FOREIGN KEY, UNIQUE, NOT NULL, References products(id) ON DELETE CASCADE \\
\hline
serving\_size\_grams & INT & NOT NULL, Standard serving size in grams \\
\hline
servings\_per\_container & DECIMAL(5, 2) & NULL, Number of servings in package \\
\hline
calories & INT & NOT NULL, Calories per serving \\
\hline
calories\_from\_fat & INT & NULL, Calories from fat per serving \\
\hline
total\_fat\_grams & DECIMAL(5, 2) & NOT NULL, Total fat in grams \\
\hline
saturated\_fat\_grams & DECIMAL(5, 2) & NULL, Saturated fat in grams \\
\hline
trans\_fat\_grams & DECIMAL(5, 2) & NULL, Trans fat in grams \\
\hline
cholesterol\_mg & INT & NULL, Cholesterol in milligrams \\
\hline
sodium\_mg & INT & NULL, Sodium in milligrams \\
\hline
total\_carbohydrates\_grams & DECIMAL(5, 2) & NOT NULL, Total carbohydrates in grams \\
\hline
dietary\_fiber\_grams & DECIMAL(5, 2) & NULL, Dietary fiber in grams \\
\hline
total\_sugars\_grams & DECIMAL(5, 2) & NOT NULL, Total sugars in grams \\
\hline
added\_sugars\_grams & DECIMAL(5, 2) & NULL, Added sugars in grams \\
\hline
protein\_grams & DECIMAL(5, 2) & NOT NULL, Protein in grams \\
\hline
vitamin\_d\_mcg & DECIMAL(5, 2) & NULL, Vitamin D in micrograms \\
\hline
calcium\_mg & INT & NULL, Calcium in milligrams \\
\hline
iron\_mg & DECIMAL(5, 2) & NULL, Iron in milligrams \\
\hline
potassium\_mg & INT & NULL, Potassium in milligrams \\
\hline
ingredients & TEXT & NULL, Comma-separated ingredient list \\
\hline
is\_vegetarian & BOOLEAN & NOT NULL, DEFAULT TRUE, Vegetarian status \\
\hline
is\_vegan & BOOLEAN & NOT NULL, DEFAULT FALSE, Vegan status \\
\hline
is\_gluten\_free & BOOLEAN & NOT NULL, DEFAULT FALSE, Gluten-free status \\
\hline
is\_sugar\_free & BOOLEAN & NOT NULL, DEFAULT FALSE, Sugar-free status \\
\hline
is\_organic & BOOLEAN & NOT NULL, DEFAULT FALSE, Organic certification \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
updated\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP \\
\hline
\caption{product\_nutrition table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item Many-to-One: products (product\_id)
\end{itemize}

\textbf{Notes:}
\begin{itemize}
    \item Nutritional values are per serving size
    \item Supports Health \& Nutrition Hub feature
    \item Enables BMI calculator and calorie tracking
    \item Powers "Perfect Match" recommendations based on user goals
\end{itemize}

\newpage

\subsection{Table 10: product\_allergens}

\begin{tablebox}{product\_allergens - Allergen Information}
\textbf{Purpose:} Tracks allergen information for products to support safe shopping.\\
\textbf{Primary Key:} id\\
\textbf{Foreign Keys:} product\_id (references products.id)\\
\textbf{Indexes:} product\_id, allergen\_type
\end{tablebox}

\begin{longtable}{|p{3.5cm}|p{2.5cm}|p{6cm}|}
\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endfirsthead

\hline
\rowcolor{tableHeader}
\textcolor{white}{\textbf{Column Name}} & \textcolor{white}{\textbf{Data Type}} & \textcolor{white}{\textbf{Constraints \& Description}} \\
\hline
\endhead

id & BIGINT & PRIMARY KEY, AUTO\_INCREMENT \\
\hline
product\_id & BIGINT & FOREIGN KEY, NOT NULL, References products(id) ON DELETE CASCADE \\
\hline
allergen\_type & ENUM & NOT NULL, Values: 'dairy', 'nuts', 'peanuts', 'tree\_nuts', 'soy', 'eggs', 'wheat', 'gluten', 'sesame', 'shellfish', 'fish', 'sulfites' \\
\hline
severity & ENUM & NOT NULL, Values: 'contains', 'may\_contain', 'processed\_in\_facility' \\
\hline
description & VARCHAR(500) & NULL, Additional allergen details or warnings \\
\hline
is\_cross\_contamination\_risk & BOOLEAN & NOT NULL, DEFAULT FALSE, Cross-contamination warning flag \\
\hline
created\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP \\
\hline
updated\_at & TIMESTAMP & NOT NULL, DEFAULT CURRENT\_TIMESTAMP ON UPDATE CURRENT\_TIMESTAMP \\
\hline
\caption{product\_allergens table structure}
\end{longtable}

\textbf{Relationships:}
\begin{itemize}
    \item Many-to-One: products (product\_id)
\end{itemize}

\textbf{Allergen Severity Levels:}
\begin{itemize}
    \item \textbf{contains:} Product directly contains this allergen
    \item \textbf{may\_contain:} Potential trace amounts due to shared equipment
    \item \textbf{processed\_in\_facility:} Manufactured in facility that processes this allergen
\end{itemize}

\textbf{Use Cases:}
\begin{itemize}
    \item Filter products based on user allergen restrictions (user\_preferences)
    \item Display warning badges on product cards and detail pages
    \item Prevent checkout if allergen conflicts detected
    \item Support Health \& Nutrition Hub feature
    \item Enable "Perfect Match" safety recommendations
\end{itemize}

\textbf{Example Records:}
\begin{itemize}
    \item Product: "Belgian Chocolate" → allergen\_type: 'dairy', severity: 'contains'
    \item Product: "Pistachio Delight" → allergen\_type: 'tree\_nuts', severity: 'contains'
    \item Product: "Vanilla Classic" → allergen\_type: 'nuts', severity: 'may\_contain'
\end{itemize}

\newpage

\section{Summary}

\begin{tcolorbox}[colback=primaryBlue!10,colframe=primaryBlue,arc=3mm,boxrule=1mm]
\textbf{\large Part 1 Complete: Tables 1-10}

\vspace{0.3cm}

This document covers the first 10 tables of the SavoyConnect database schema:

\begin{itemize}
    \item \textbf{User Management (6 tables):} users, user\_profiles, user\_preferences, user\_addresses, sessions, password\_resets
    \item \textbf{Product Catalog (4 tables):} products, product\_categories, product\_nutrition, product\_allergens
\end{itemize}

\vspace{0.3cm}

\textbf{Key Features Implemented:}
\begin{itemize}
    \item Complete user authentication with email/phone verification
    \item Secure session management with device tracking
    \item Multi-address support with geocoding
    \item Comprehensive product catalog with nutrition and allergen data
    \item Hierarchical category structure
    \item Health-conscious shopping support
\end{itemize}

\vspace{0.3cm}

\textbf{Next Document:} Part 2 will cover tables 11-20 (Order Management, Location \& Inventory, Delivery Tracking)

\end{tcolorbox}

\end{document}
